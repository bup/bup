Notable changes in 0.33.x since 0.33.4 (incomplete)
===================================================

General
-------

* `bup validate-object-links` has been added.  This command scans the
  objects in the repository and reports any "broken links" it finds,
  i.e. any links from a tree or commit in the repository to an object
  that doesn't exist.

* `bup validate-ref-links` has been added.  This command traverses all
  repository references (e.g. saves) and logs paths to missing
  objects, i.e. references from a tree or commit to an object that
  doesn't exist in the repository.  At the moment, it will report at
  least one path to each missing object; it does not attempt to find
  all of the paths.

* `bup gc` now provides `--ignore-missing` which allows a `gc`
  operation to continue after encountering objects that are missing
  from the repository.

* `bup join` now reports the path to any missing object it encounters.

Bugs
----

* `bup gc` should no longer risk leaving the repository with
  incomplete tree or commit objects -- trees or commits with
  references to objects that are no longer in the repository.

  Previously this could happen because the collection was
  probabilistic with respect to all object types, and so it could
  leave (completely orphaned) vestigial commits or trees that referred
  to objects that had been removed.  It could also do this if the
  `--threshold` caused it to keep a parent in one "live enough" pack,
  while discarding a descendant in a pack that doesn't cross the
  threshold.

  These objects can cause serious trouble because they can be re-used
  as-is (without noticing that they are incomplete) by other commands
  like `bup get`.

* `bup get` should no longer be able to leave the repository with
  incomplete trees or commits if it's interrupted at the wrong time.
  Previously it fetched objects "top down", and so if it was
  interrupted after the parent tree/commit was written to the
  repository, but before all the children were written, then the
  repository would be left with an incomplete tree.

* `bup` should always ignore midx files that refer to missing indexes.
  Previously it might not notice when objects had disappeared (via
  `gc`) which could, in particular, cause remote/client operations
  like a remote save to decide that the repository already contained
  data that it did not.

* `bup midx` `--auto` and `--force` now delete midx files that refer
  to missing indexes.

* `bup gc` should no longer throw bloom close-related exceptions when
  interrupted.

Build system
------------

* [Graphviz](https://graphviz.org) `dot` is optional, but must be
  available in order to render the figures referred to by
  issue/missing-objects.md.

Thanks to (at least)
====================

Johannes Berg, Rob Browning, and ...
